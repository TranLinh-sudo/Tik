-- CẤU HÌNH --
local TERMUX_IP = "192.168.0.108" -- Đổi thành IP máy chạy Termux của bạn
local PORT = "5000"
local URL = "http://" .. TERMUX_IP .. ":" .. PORT .. "/update"

local Players = game:GetService("Players")
local Client = Players.LocalPlayer
local HttpService = game:GetService("HttpService")

-- Giá của các trái cây (Ví dụ một số trái phổ biến > 1M, bạn có thể bổ sung)
local FruitPrices = {
    ["Rocket"] = 5000, -- Ví dụ trái rẻ
    ["Quake"] = 1000000,
    ["Buddha"] = 1200000,
    ["Phoenix"] = 1800000,
    ["Rumble"] = 2100000,
    ["Portal"] = 1900000,
    ["Dough"] = 2800000,
    ["Dragon"] = 3500000,
    ["Leopard"] = 5000000,
    ["Kitsune"] = 8000000,
    ["T-Rex"] = 2700000,
    ["Mammoth"] = 2700000,
    ["Spirit"] = 2500000,
    ["Venom"] = 3000000,
    ["Control"] = 3200000
    -- Thêm các trái khác vào đây
}

-- Hàm lấy trái cây trong kho (Logic này phụ thuộc vào game update, đây là logic quét Inventory cơ bản)
-- Lưu ý: Blox Fruits giấu Inventory khá kỹ, thường phải đọc qua Remote hoặc UI.
-- Đây là giả lập việc đọc từ một Folder dữ liệu thường thấy trong các script Hub.
function GetHighValueFruits()
    local highValueFruits = {}
    
    -- Cách lấy trái cây: Kiểm tra trong Backpack hoặc UI Stored Items
    -- Vì mỗi bản update Blox Fruit lại đổi chỗ lưu, nên ta sẽ dùng logic quét tên cơ bản
    -- Bạn có thể tích hợp script này vào Auto Farm Hub có sẵn chức năng get inventory
    
    -- DEMO: Quét trong Backpack (Trái đang cầm)
    if Client.Backpack then
        for _, item in pairs(Client.Backpack:GetChildren()) do
            if item:IsA("Tool") and item.ToolTip == "Blox Fruit" then
                -- Check giá (Logic đơn giản hóa)
                local fruitName = item.Name
                local price = FruitPrices[fruitName] or 0
                if price >= 1000000 then
                    table.insert(highValueFruits, fruitName .. " (Đang cầm)")
                end
            end
        end
    end

    -- Lưu ý: Để lấy toàn bộ trái trong kho (Stored), bạn cần hook vào Remotes của game
    -- Ví dụ giả định gửi dữ liệu mẫu nếu không hook được:
    -- table.insert(highValueFruits, "Dough (Giả lập)") 
    
    return highValueFruits
end

-- Vòng lặp gửi dữ liệu
spawn(function()
    while task.wait(5) do -- Gửi mỗi 5 giây để tránh lag
        pcall(function()
            -- Lấy thông tin cơ bản
            local Level = Client.Data.Level.Value
            local Beli = Client.Data.Beli.Value
            local Fragment = Client.Data.Fragments.Value
            local Fruits = GetHighValueFruits()

            -- Tạo bảng dữ liệu JSON
            local dataToSend = {
                name = Client.Name,
                level = Level,
                beli = Beli,
                fragment = Fragment,
                fruits = Fruits
            }

            -- Chuyển sang JSON
            local jsonData = HttpService:JSONEncode(dataToSend)

            -- Gửi Request
            local response = request({
                Url = URL,
                Method = "POST",
                Headers = {
                    ["Content-Type"] = "application/json"
                },
                Body = jsonData
            })
            
            -- Debug in ra console (F9)
            print("Đã gửi dữ liệu về Termux: " .. tostring(response.StatusCode))
        end)
    end
end)
